<!DOCTYPE html>
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title></title>
    <style media="screen">
         html, body {
           width: 100%;
           height: 100%;
         }

         #table {
           background-color: #8CE03B;
           border: 5px solid #5F3700;
           border-radius: 5%;
           width: 70%;
           height: 50%;
           position: absolute;
           top: 10%;
           left: 10%;
         }

         #dealer-hand {
           background-color: #478807;
           width: 70%;
           height: 100px;
           margin-bottom: 5%;
           margin-left: 15%;
           margin-right: 15%;
         }

         #player-hand {
           background-color: #478807;
           width: 70%;
           height: 100px;
           margin-bottom: 5%;
           margin-left: 15%;
           margin-right: 15%;
         }

         .card {
           width: 50px;
           margin: 10px 5px 0 5px;

         }
    </style>
  </head>
  <body>
    <div id="table">

    <div id="messages"></div>
    <label>Dealer: </label>

    <label id="dealer-points" class="points"></label>

    <div id="dealer-hand" class="hand">

    </div>

    <label>Player: </label>

    <label id="player-points" class="points"> </label>

    <div id="player-hand" class="hand">

    </div>

    <div class="buttons">

    <button id="deal-button">Deal</button>

    <button id="hit-button">Hit</button>

    <button id="stand-button">Stand</button>

    </div>

    </div>

    <script type="text/javascript" >
          //dealer
          var dealerHand = document.getElementById('dealer-hand');
          var dealerPoints = document.getElementById('dealer-points')
          var dealerHandVal = {
            points: 0,
          }

          //player
          var playerHand = document.getElementById('player-hand');
          var playerPoints = document.getElementById('player-points')
          var playerHandVal = {
            points: 0
          }

          var deal = document.getElementById('deal-button');
          var hit = document.getElementById('hit-button');

          var stand = document.getElementById('stand-button')




          function initGame() {
            var begin = prompt("Wanna play a game?")
            dealerHandVal.points = 0;
            playerHandVal.points = 0;

            function cardPrototype(points, suit, image = null) {
              this.points = points;
              this.suit = suit;
              this.image = image;
              this.played = false;
            }

            var deck = [];

            function fillDeck(arr) {
              for (var i = 0; i < 4; i ++) {
                for (var j = 1; j < 14; j ++) {
                  if (i === 0) {
                    arr.push(new cardPrototype (j, "diamonds", "../JPEG/" + String(j) + "D.jpg"))
                  } else if (i === 1) {
                      arr.push(new cardPrototype (j, "hearts", "../JPEG/" + String(j) + "H.jpg"))
                  } else if (i === 2) {
                      arr.push(new cardPrototype (j, "clubs", "../JPEG/" + String(j) + "C.jpg"))
                  } else if (i === 3) {
                      arr.push(new cardPrototype (j, "spades", "../JPEG/" + String(j) + "S.jpg"))
                  }
                }
              }
            }
            fillDeck(deck)


            function addCardToHand(deck, hand, points) {
              var cardToAdd = deck[Math.floor(Math.random() * Math.floor(deck.length))]
              while (cardToAdd.played === true) {
                cardToAdd = deck[Math.floor(Math.random() * Math.floor(deck.length))]
              }
              var card = document.createElement('img')
              card.src = cardToAdd.image;
              card.classList.add('card')
              hand.append(card)
              points.points += cardToAdd.points
              cardToAdd.played = true
              console.log(deck.indexOf(cardToAdd))
              deck.splice(deck.indexOf(cardToAdd), 1)
              console.log(deck.length)
            }


            function endGame(caller, opponent) {
              window.alert(`You won with ${caller.points} to the dealer's ${opponent.points}`)
              var playAgain = "";
              while(playAgain != "Y" || playAgain != "N") {
                playAgain = prompt("Wanna play again? (Y/N)").toUpperCase();
                if (playAgain == "Y" || playAgain == "N") {
                  break;
                }
              }
              if (playAgain == "Y") {
                location.reload();
              } else {
                location.href = "https://www.google.com/"
              }
            }

            // addCardToHand(deck, playerHand, playerPoints)
            hit.addEventListener("click", function() {
               addCardToHand(deck, playerHand, playerHandVal)
               addCardToHand(deck, dealerHand, dealerHandVal)
               console.log("hand val:", playerHandVal.points)
               if (dealerHandVal.points > 21 || playerHandVal.points === 21) {
                 endGame(playerHandVal, dealerHandVal)
               } else if (dealerHandVal.points === 21 || playerHandVal.points > 21) {
                 endGame(dealerHandVal, playerHandVal)
               }
            })

            stand.addEventListener("click", function() {
              addCardToHand(deck, dealerHand, dealerHandVal);
              if (dealerHandVal.points > 21 || playerHandVal.points === 21) {
                endGame(playerHandVal, dealerHandVal)
              } else if (dealerHandVal.points === 21 || playerHandVal.points > 21) {
                endGame(dealerHandVal, playerHandVal)
              }
            })

            deal.addEventListener('click', function() {
              addCardToHand(deck, playerHand, playerHandVal)
              addCardToHand(deck, dealerHand, dealerHandVal)
            }, {once: true})



          }

          initGame()




    </script>
  </body>

</html>
